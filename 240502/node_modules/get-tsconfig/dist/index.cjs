"use strict";var p=require("path"),V=require("fs"),ge=require("module"),ae=require("resolve-pkg-maps");function B(e){return e.startsWith("\\\\?\\")?e:e.replace(/\\/g,"/")}const P=e=>{const s=V[e];return(i,...n)=>{const t=`${e}:${n.join(":")}`;let o=i==null?void 0:i.get(t);return o===void 0&&(o=Reflect.apply(s,V,n),i==null||i.set(t,o)),o}},E=P("existsSync"),me=P("realpathSync"),ke=P("readFileSync"),x=P("statSync"),Y=(e,s,i)=>{for(;;){const n=p.posix.join(e,s);if(E(i,n))return n;const t=p.dirname(e);if(t===e)return;e=t}},d=/^\.{1,2}(\/.*)?$/,M=e=>{const s=B(e);return d.test(s)?s:`./${s}`};function be(e,s=!1){const i=e.length;let n=0,t="",o=0,l=16,a=0,r=0,b=0,w=0,c=0;function L(u,g){let f=0,$=0;for(;f<u||!g;){let O=e.charCodeAt(n);if(O>=48&&O<=57)$=$*16+O-48;else if(O>=65&&O<=70)$=$*16+O-65+10;else if(O>=97&&O<=102)$=$*16+O-97+10;else break;n++,f++}return f<u&&($=-1),$}function T(u){n=u,t="",o=0,l=16,c=0}function v(){let u=n;if(e.charCodeAt(n)===48)n++;else for(n++;n<e.length&&N(e.charCodeAt(n));)n++;if(n<e.length&&e.charCodeAt(n)===46)if(n++,n<e.length&&N(e.charCodeAt(n)))for(n++;n<e.length&&N(e.charCodeAt(n));)n++;else return c=3,e.substring(u,n);let g=n;if(n<e.length&&(e.charCodeAt(n)===69||e.charCodeAt(n)===101))if(n++,(n<e.length&&e.charCodeAt(n)===43||e.charCodeAt(n)===45)&&n++,n<e.length&&N(e.charCodeAt(n))){for(n++;n<e.length&&N(e.charCodeAt(n));)n++;g=n}else c=3;return e.substring(u,g)}function k(){let u="",g=n;for(;;){if(n>=i){u+=e.substring(g,n),c=2;break}const f=e.charCodeAt(n);if(f===34){u+=e.substring(g,n),n++;break}if(f===92){if(u+=e.substring(g,n),n++,n>=i){c=2;break}switch(e.charCodeAt(n++)){case 34:u+='"';break;case 92:u+="\\";break;case 47:u+="/";break;case 98:u+="\b";break;case 102:u+="\f";break;case 110:u+=`
`;break;case 114:u+="\r";break;case 116:u+="	";break;case 117:const O=L(4,!0);O>=0?u+=String.fromCharCode(O):c=4;break;default:c=5}g=n;continue}if(f>=0&&f<=31)if(_(f)){u+=e.substring(g,n),c=2;break}else c=6;n++}return u}function j(){if(t="",c=0,o=n,r=a,w=b,n>=i)return o=i,l=17;let u=e.charCodeAt(n);if(W(u)){do n++,t+=String.fromCharCode(u),u=e.charCodeAt(n);while(W(u));return l=15}if(_(u))return n++,t+=String.fromCharCode(u),u===13&&e.charCodeAt(n)===10&&(n++,t+=`
`),a++,b=n,l=14;switch(u){case 123:return n++,l=1;case 125:return n++,l=2;case 91:return n++,l=3;case 93:return n++,l=4;case 58:return n++,l=6;case 44:return n++,l=5;case 34:return n++,t=k(),l=10;case 47:const g=n-1;if(e.charCodeAt(n+1)===47){for(n+=2;n<i&&!_(e.charCodeAt(n));)n++;return t=e.substring(g,n),l=12}if(e.charCodeAt(n+1)===42){n+=2;const f=i-1;let $=!1;for(;n<f;){const O=e.charCodeAt(n);if(O===42&&e.charCodeAt(n+1)===47){n+=2,$=!0;break}n++,_(O)&&(O===13&&e.charCodeAt(n)===10&&n++,a++,b=n)}return $||(n++,c=1),t=e.substring(g,n),l=13}return t+=String.fromCharCode(u),n++,l=16;case 45:if(t+=String.fromCharCode(u),n++,n===i||!N(e.charCodeAt(n)))return l=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return t+=v(),l=11;default:for(;n<i&&U(u);)n++,u=e.charCodeAt(n);if(o!==n){switch(t=e.substring(o,n),t){case"true":return l=8;case"false":return l=9;case"null":return l=7}return l=16}return t+=String.fromCharCode(u),n++,l=16}}function U(u){if(W(u)||_(u))return!1;switch(u){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function F(){let u;do u=j();while(u>=12&&u<=15);return u}return{setPosition:T,getPosition:()=>n,scan:s?F:j,getToken:()=>l,getTokenValue:()=>t,getTokenOffset:()=>o,getTokenLength:()=>n-o,getTokenStartLine:()=>r,getTokenStartCharacter:()=>o-w,getTokenError:()=>c}}function W(e){return e===32||e===9}function _(e){return e===10||e===13}function N(e){return e>=48&&e<=57}var Z;(function(e){e[e.lineFeed=10]="lineFeed",e[e.carriageReturn=13]="carriageReturn",e[e.space=32]="space",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.asterisk=42]="asterisk",e[e.backslash=92]="backslash",e[e.closeBrace=125]="closeBrace",e[e.closeBracket=93]="closeBracket",e[e.colon=58]="colon",e[e.comma=44]="comma",e[e.dot=46]="dot",e[e.doubleQuote=34]="doubleQuote",e[e.minus=45]="minus",e[e.openBrace=123]="openBrace",e[e.openBracket=91]="openBracket",e[e.plus=43]="plus",e[e.slash=47]="slash",e[e.formFeed=12]="formFeed",e[e.tab=9]="tab"})(Z||(Z={}));var I;(function(e){e.DEFAULT={allowTrailingComma:!1}})(I||(I={}));function Te(e,s=[],i=I.DEFAULT){let n=null,t=[];const o=[];function l(r){Array.isArray(t)?t.push(r):n!==null&&(t[n]=r)}return ve(e,{onObjectBegin:()=>{const r={};l(r),o.push(t),t=r,n=null},onObjectProperty:r=>{n=r},onObjectEnd:()=>{t=o.pop()},onArrayBegin:()=>{const r=[];l(r),o.push(t),t=r,n=null},onArrayEnd:()=>{t=o.pop()},onLiteralValue:l,onError:(r,b,w)=>{s.push({error:r,offset:b,length:w})}},i),t[0]}function ve(e,s,i=I.DEFAULT){const n=be(e,!1),t=[];function o(m){return m?()=>m(n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter()):()=>!0}function l(m){return m?()=>m(n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter(),()=>t.slice()):()=>!0}function a(m){return m?A=>m(A,n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter()):()=>!0}function r(m){return m?A=>m(A,n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter(),()=>t.slice()):()=>!0}const b=l(s.onObjectBegin),w=r(s.onObjectProperty),c=o(s.onObjectEnd),L=l(s.onArrayBegin),T=o(s.onArrayEnd),v=r(s.onLiteralValue),k=a(s.onSeparator),j=o(s.onComment),U=a(s.onError),F=i&&i.disallowComments,u=i&&i.allowTrailingComma;function g(){for(;;){const m=n.scan();switch(n.getTokenError()){case 4:f(14);break;case 5:f(15);break;case 3:f(13);break;case 1:F||f(11);break;case 2:f(12);break;case 6:f(16);break}switch(m){case 12:case 13:F?f(10):j();break;case 16:f(1);break;case 15:case 14:break;default:return m}}}function f(m,A=[],X=[]){if(U(m),A.length+X.length>0){let y=n.getToken();for(;y!==17;){if(A.indexOf(y)!==-1){g();break}else if(X.indexOf(y)!==-1)break;y=g()}}}function $(m){const A=n.getTokenValue();return m?v(A):(w(A),t.push(A)),g(),!0}function O(){switch(n.getToken()){case 11:const m=n.getTokenValue();let A=Number(m);isNaN(A)&&(f(2),A=0),v(A);break;case 7:v(null);break;case 8:v(!0);break;case 9:v(!1);break;default:return!1}return g(),!0}function ce(){return n.getToken()!==10?(f(3,[],[2,5]),!1):($(!1),n.getToken()===6?(k(":"),g(),h()||f(4,[],[2,5])):f(5,[],[2,5]),t.pop(),!0)}function fe(){b(),g();let m=!1;for(;n.getToken()!==2&&n.getToken()!==17;){if(n.getToken()===5){if(m||f(4,[],[]),k(","),g(),n.getToken()===2&&u)break}else m&&f(6,[],[]);ce()||f(4,[],[2,5]),m=!0}return c(),n.getToken()!==2?f(7,[2],[]):g(),!0}function pe(){L(),g();let m=!0,A=!1;for(;n.getToken()!==4&&n.getToken()!==17;){if(n.getToken()===5){if(A||f(4,[],[]),k(","),g(),n.getToken()===4&&u)break}else A&&f(6,[],[]);m?(t.push(0),m=!1):t[t.length-1]++,h()||f(4,[],[4,5]),A=!0}return T(),m||t.pop(),n.getToken()!==4?f(8,[4],[]):g(),!0}function h(){switch(n.getToken()){case 3:return pe();case 1:return fe();case 10:return $(!0);default:return O()}}return g(),n.getToken()===17?i.allowEmptyContent?!0:(f(4,[],[]),!1):h()?(n.getToken()!==17&&f(9,[],[]),!0):(f(4,[],[]),!1)}var K;(function(e){e[e.None=0]="None",e[e.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=2]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",e[e.InvalidUnicode=4]="InvalidUnicode",e[e.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",e[e.InvalidCharacter=6]="InvalidCharacter"})(K||(K={}));var C;(function(e){e[e.OpenBraceToken=1]="OpenBraceToken",e[e.CloseBraceToken=2]="CloseBraceToken",e[e.OpenBracketToken=3]="OpenBracketToken",e[e.CloseBracketToken=4]="CloseBracketToken",e[e.CommaToken=5]="CommaToken",e[e.ColonToken=6]="ColonToken",e[e.NullKeyword=7]="NullKeyword",e[e.TrueKeyword=8]="TrueKeyword",e[e.FalseKeyword=9]="FalseKeyword",e[e.StringLiteral=10]="StringLiteral",e[e.NumericLiteral=11]="NumericLiteral",e[e.LineCommentTrivia=12]="LineCommentTrivia",e[e.BlockCommentTrivia=13]="BlockCommentTrivia",e[e.LineBreakTrivia=14]="LineBreakTrivia",e[e.Trivia=15]="Trivia",e[e.Unknown=16]="Unknown",e[e.EOF=17]="EOF"})(C||(C={}));const we=Te;var ee;(function(e){e[e.InvalidSymbol=1]="InvalidSymbol",e[e.InvalidNumberFormat=2]="InvalidNumberFormat",e[e.PropertyNameExpected=3]="PropertyNameExpected",e[e.ValueExpected=4]="ValueExpected",e[e.ColonExpected=5]="ColonExpected",e[e.CommaExpected=6]="CommaExpected",e[e.CloseBraceExpected=7]="CloseBraceExpected",e[e.CloseBracketExpected=8]="CloseBracketExpected",e[e.EndOfFileExpected=9]="EndOfFileExpected",e[e.InvalidCommentToken=10]="InvalidCommentToken",e[e.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=12]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",e[e.InvalidUnicode=14]="InvalidUnicode",e[e.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",e[e.InvalidCharacter=16]="InvalidCharacter"})(ee||(ee={}));const ne=(e,s)=>we(ke(s,e,"utf8")),J=Symbol("implicitBaseUrl"),Oe=()=>{const{findPnpApi:e}=ge;return e&&e(process.cwd())},R=(e,s,i,n)=>{const t=`resolveFromPackageJsonPath:${e}:${s}:${i}`;if(n!=null&&n.has(t))return n.get(t);const o=ne(e,n);if(!o)return;let l=s||"tsconfig.json";if(!i&&o.exports)try{const[a]=ae.resolveExports(o.exports,s,["require","types"]);l=a}catch{return!1}else!s&&o.tsconfig&&(l=o.tsconfig);return l=p.join(e,"..",l),n==null||n.set(t,l),l},G="package.json",z="tsconfig.json",Ae=(e,s,i)=>{let n=e;if(e===".."&&(n=p.join(n,z)),e[0]==="."&&(n=p.resolve(s,n)),p.isAbsolute(n)){if(E(i,n)){if(x(i,n).isFile())return n}else if(!n.endsWith(".json")){const T=`${n}.json`;if(E(i,T))return T}return}const[t,...o]=e.split("/"),l=t[0]==="@"?`${t}/${o.shift()}`:t,a=o.join("/"),r=Oe();if(r){const{resolveRequest:T}=r;try{if(l===e){const v=T(p.join(l,G),s);if(v){const k=R(v,a,!1,i);if(k&&E(i,k))return k}}else{let v;try{v=T(e,s,{extensions:[".json"]})}catch{v=T(p.join(e,z),s)}if(v)return v}}catch{}}const b=Y(s,p.join("node_modules",l),i);if(!b||!x(i,b).isDirectory())return;const w=p.join(b,G);if(E(i,w)){const T=R(w,a,!1,i);if(T===!1)return;if(T&&E(i,T)&&x(i,T).isFile())return T}const c=p.join(b,a),L=c.endsWith(".json");if(!L){const T=`${c}.json`;if(E(i,T))return T}if(E(i,c)){if(x(i,c).isDirectory()){const T=p.join(c,G);if(E(i,T)){const k=R(T,"",!0,i);if(k&&E(i,k))return k}const v=p.join(c,z);if(E(i,v))return v}else if(L)return c}},je=(e,s,i,n)=>{const t=Ae(e,s,n);if(!t)throw new Error(`File '${e}' not found.`);if(i.has(t))throw new Error(`Circularity detected while resolving configuration: ${t}`);i.add(t);const o=p.dirname(t),l=te(t,n,i);delete l.references;const{compilerOptions:a}=l;if(a){const r=["baseUrl","outDir"];for(const b of r){const w=a[b];w&&(a[b]=B(p.relative(s,p.join(o,w)))||"./")}}return l.files&&(l.files=l.files.map(r=>B(p.relative(s,p.join(o,r))))),l.include&&(l.include=l.include.map(r=>B(p.relative(s,p.join(o,r))))),l.exclude&&(l.exclude=l.exclude.map(r=>B(p.relative(s,p.join(o,r))))),l},te=(e,s,i=new Set)=>{let n;try{n=me(s,e)}catch{throw new Error(`Cannot resolve tsconfig at path: ${e}`)}let t=ne(n,s)||{};if(typeof t!="object")throw new SyntaxError(`Failed to parse tsconfig at: ${e}`);const o=p.dirname(n);if(t.compilerOptions){const{compilerOptions:l}=t;l.paths&&!l.baseUrl&&(l[J]=o)}if(t.extends){const l=Array.isArray(t.extends)?t.extends:[t.extends];delete t.extends;for(const a of l.reverse()){const r=je(a,o,new Set(i),s),b={...r,...t,compilerOptions:{...r.compilerOptions,...t.compilerOptions}};r.watchOptions&&(b.watchOptions={...r.watchOptions,...t.watchOptions}),t=b}}if(t.compilerOptions){const{compilerOptions:l}=t,a=["baseUrl","rootDir"];for(const b of a){const w=l[b];if(w){const c=p.resolve(o,w),L=M(p.relative(o,c));l[b]=L}}const{outDir:r}=l;r&&(Array.isArray(t.exclude)||(t.exclude=[]),t.exclude.includes(r)||t.exclude.push(r),l.outDir=M(r))}else t.compilerOptions={};if(t.files&&(t.files=t.files.map(M)),t.include&&(t.include=t.include.map(B)),t.watchOptions){const{watchOptions:l}=t;l.excludeDirectories&&(l.excludeDirectories=l.excludeDirectories.map(a=>B(p.resolve(o,a))))}return t},ie=(e,s=new Map)=>te(e,s),$e=(e=process.cwd(),s="tsconfig.json",i=new Map)=>{const n=Y(B(e),s,i);if(!n)return null;const t=ie(n,i);return{path:n,config:t}},Be=/\*/g,se=(e,s)=>{const i=e.match(Be);if(i&&i.length>1)throw new Error(s)},Ee=e=>{if(e.includes("*")){const[s,i]=e.split("*");return{prefix:s,suffix:i}}return e},Le=({prefix:e,suffix:s},i)=>i.startsWith(e)&&i.endsWith(s),Ue=(e,s,i)=>Object.entries(e).map(([n,t])=>(se(n,`Pattern '${n}' can have at most one '*' character.`),{pattern:Ee(n),substitutions:t.map(o=>{if(se(o,`Substitution '${o}' in pattern '${n}' can have at most one '*' character.`),!s&&!d.test(o))throw new Error("Non-relative paths are not allowed when 'baseUrl' is not set. Did you forget a leading './'?");return p.resolve(i,o)})})),Fe=e=>{if(!e.config.compilerOptions)return null;const{baseUrl:s,paths:i}=e.config.compilerOptions,n=J in e.config.compilerOptions&&e.config.compilerOptions[J];if(!s&&!i)return null;const t=p.resolve(p.dirname(e.path),s||n||"."),o=i?Ue(i,s,t):[];return l=>{if(d.test(l))return[];const a=[];for(const c of o){if(c.pattern===l)return c.substitutions.map(B);typeof c.pattern!="string"&&a.push(c)}let r,b=-1;for(const c of a)Le(c.pattern,l)&&c.pattern.prefix.length>b&&(b=c.pattern.prefix.length,r=c);if(!r)return s?[B(p.join(t,l))]:[];const w=l.slice(r.pattern.prefix.length,l.length-r.pattern.suffix.length);return r.substitutions.map(c=>B(c.replace("*",w)))}},le=e=>{let s="";for(let i=0;i<e.length;i+=1){const n=e[i],t=n.toUpperCase();s+=n===t?n.toLowerCase():t}return s},Ne=65,_e=97,ye=()=>Math.floor(Math.random()*26),Pe=e=>Array.from({length:e},()=>String.fromCodePoint(ye()+(Math.random()>.5?Ne:_e))).join(""),xe=(e=V)=>{const s=process.execPath;if(e.existsSync(s))return!e.existsSync(le(s));const i=`/${Pe(10)}`;e.writeFileSync(i,"");const n=!e.existsSync(le(i));return e.unlinkSync(i),n},{join:D}=p.posix,Q={ts:[".ts",".tsx",".d.ts"],cts:[".cts",".d.cts"],mts:[".mts",".d.mts"]},Ie=e=>{const s=[...Q.ts],i=[...Q.cts],n=[...Q.mts];return e!=null&&e.allowJs&&(s.push(".js",".jsx"),i.push(".cjs"),n.push(".mjs")),[...s,...i,...n]},De=e=>{const s=[];if(!e)return s;const{outDir:i,declarationDir:n}=e;return i&&s.push(i),n&&s.push(n),s},oe=e=>e.replaceAll(/[.*+?^${}()|[\]\\]/g,"\\$&"),Se=["node_modules","bower_components","jspm_packages"],H=`(?!(${Se.join("|")})(/|$))`,he=/(?:^|\/)[^.*?]+$/,ue="**/*",S="[^/]",q="[^./]",re=process.platform==="win32",Ve=({config:e,path:s},i=xe())=>{if("extends"in e)throw new Error("tsconfig#extends must be resolved. Use getTsconfig or parseTsconfig to resolve it.");if(!p.isAbsolute(s))throw new Error("The tsconfig path must be absolute");re&&(s=B(s));const n=p.dirname(s),{files:t,include:o,exclude:l,compilerOptions:a}=e,r=t==null?void 0:t.map(k=>D(n,k)),b=Ie(a),w=i?"":"i",L=(l||De(a)).map(k=>{const j=D(n,k),U=oe(j).replaceAll("\\*\\*/","(.+/)?").replaceAll("\\*",`${S}*`).replaceAll("\\?",S);return new RegExp(`^${U}($|/)`,w)}),T=t||o?o:[ue],v=T?T.map(k=>{let j=D(n,k);he.test(j)&&(j=D(j,ue));const U=oe(j).replaceAll("/\\*\\*",`(/${H}${q}${S}*)*?`).replaceAll(/(\/)?\\\*/g,(F,u)=>{const g=`(${q}|(\\.(?!min\\.js$))?)*`;return u?`/${H}${q}${g}`:g}).replaceAll(/(\/)?\\\?/g,(F,u)=>{const g=S;return u?`/${H}${g}`:g});return new RegExp(`^${U}$`,w)}):void 0;return k=>{if(!p.isAbsolute(k))throw new Error("filePath must be absolute");if(re&&(k=B(k)),r!=null&&r.includes(k))return e;if(!(!b.some(j=>k.endsWith(j))||L.some(j=>j.test(k)))&&v&&v.some(j=>j.test(k)))return e}};exports.createFilesMatcher=Ve,exports.createPathsMatcher=Fe,exports.getTsconfig=$e,exports.parseTsconfig=ie;
